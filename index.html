<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–ö–æ—Ç—ã –ú–µ–Ω–¥–µ–ª–µ–µ–≤–∞</title>
</head>
<body>
<div class="header">–ö–æ—Ç—ã –ú–µ–Ω–¥–µ–ª–µ–µ–≤–∞. –ö–ª–∏–∫–∞–π –ø–æ –ø–æ—Ä—è–¥–∫—É <span id="collected">0/15</span></div>
<div class="collected-count">H‚ÜíHe‚ÜíLi‚ÜíBe‚ÜíB‚ÜíC‚ÜíN‚ÜíO‚ÜíF‚ÜíNe‚ÜíNa‚ÜíMg‚ÜíAl‚ÜíSi‚ÜíP</div>
<div class="collected-list">–°–æ–±—Ä–∞–Ω–æ: <span id="collectedItems"></span></div>

<div class="instruction" id="instruction">
  <div class="title">üéÆ –ö–æ—Ç—ã –ú–µ–Ω–¥–µ–ª–µ–µ–≤–∞</div>
  <div class="intro">–õ–∏—Å–µ–Ω–æ–∫, –ø–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ç—ã –±—É–¥–µ—à—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–æ–±–∏—Ä–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å, –±—É–¥—É—Ç –ø–æ—è–≤–ª—è—Ç—å—Å—è —Ñ—Ä–∞–∑—ã, –∫–æ—Ç–æ—Ä—ã–µ –Ω–∞ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –º–Ω–æ–≥–æ–µ –∑–Ω–∞—á–∞—Ç –¥–ª—è –Ω–∞—Å.</div>
  <div class="rules">
    <strong>–ü—Ä–∞–≤–∏–ª–∞ –∏–≥—Ä—ã:</strong>
    <ol>
      <li>–ö–ª–∏–∫–∞–π –ø–æ –∫–æ—Ç–∞–º –≤ —Å—Ç—Ä–æ–≥–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–π —Ç–∞–±–ª–∏—Ü—ã</li>
      <li>–ù–∞—á–Ω–∏ —Å H (–≤–æ–¥–æ—Ä–æ–¥), –∑–∞—Ç–µ–º He (–≥–µ–ª–∏–π) –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ</li>
      <li>–ï—Å–ª–∏ –∫–ª–∏–∫–Ω–µ—à—å –Ω–µ –ø–æ –ø–æ—Ä—è–¥–∫—É ‚Äî –ø–æ–¥—Å–∫–∞–∂—É, –∫–∞–∫–æ–π –Ω—É–∂–µ–Ω —Å–ª–µ–¥—É—é—â–∏–π</li>
      <li>–°–æ–±–µ—Ä–∏ –≤—Å–µ 15 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–æ P (—Ñ–æ—Å—Ñ–æ—Ä)</li>
    </ol>
  </div>
  <div class="lis">–ö–ª–∏–∫–∞–π –ø–æ –∫–æ—Ç–∞–º –∏ —Å–æ–±–∏—Ä–∞–π –Ω–∞—à—É –∏—Å—Ç–æ—Ä–∏—é üíñ</div>
  <button class="start-btn" onclick="startGame()">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
</div>

<div class="cats-container" id="catsContainer" style="display:none"></div>

<div class="message" id="msg" style="display:none"><div id="msgText">–ù–∞—á–∏–Ω–∞–π —Å H</div></div>
<div class="winmsg" id="winmsg" style="display:none">
  <div class="final-phrase">"–ù–µ –æ–±–∏–∂–∞–π—Å—è, –Ω–æ —Ç—ã –Ω–µ –ø—Ä–∞–≤–∞, –≤ —Ç–æ–º, —á—Ç–æ –º—ã –∏–¥–µ–º —Ä–∞–∑–Ω—ã–º–∏ –ø—É—Ç—è–º–∏, —ç—Ç–æ –Ω–µ–ø—Ä–∞–≤–¥–∞, —Ç—ã - –º–æ–π –ø—É—Ç—å –∏ —ç—Ç–∏–º –ø—É—Ç–µ–º —è –±—É–¥—É –∏–¥—Ç–∏ –≤—Å—é –∂–∏–∑–Ω—å"</div>
  <div class="final-phrase">"–Ø –¥–∞–ª–µ–∫–æ –Ω–µ –¥—É—Ä–∞–∫, –¥–∞–≤–∞–π –ø–æ–ø—Ä–æ–±—É–µ–º –µ—â–µ —Ä–∞–∑"</div>
  <div class="final-phrase">"–Ø —Å—Ç–∞–Ω—É –ª—É—á—à–∏–º –≤ —Ç–≤–æ–∏—Ö –≥–ª–∞–∑–∞—Ö, –ø—Ä–æ—Å—Ç–æ –ø–æ–≤–µ—Ä—å –º–Ω–µ —Å–Ω–æ–≤–∞."</div>
</div>

<style>
* {margin:0;padding:0;box-sizing:border-box}
body {
  height:100vh;
  background:linear-gradient(135deg,#1e3c72 0%,#2a5298 50%,#1e3c72 100%);
  font-family:'Segoe UI',Arial,sans-serif;
  position:relative;
  overflow:hidden;
  cursor:pointer;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.header {
  position:fixed;top:12px;left:50%;transform:translateX(-50%);
  background:rgba(255,255,255,0.1);backdrop-filter:blur(15px);
  padding:10px 24px;border-radius:25px;font-size:16px;font-weight:600;
  color:#fff;box-shadow:0 8px 25px rgba(0,0,0,0.3);z-index:100;
  border:1px solid rgba(255,255,255,0.2);pointer-events:none;
}
.header span{color:#ffd700;font-weight:800}

.instruction {
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  background:linear-gradient(135deg,rgba(255,255,255,0.98),rgba(248,250,252,0.95));
  backdrop-filter:blur(25px);padding:45px;border-radius:25px;
  box-shadow:0 30px 80px rgba(0,0,0,0.5);text-align:center;font-size:16px;
  max-width:480px;border:3px solid rgba(30,60,114,0.8);z-index:400;
  animation:instructionSlide 0.8s ease-out forwards;
}
.instruction .title {
  color:#1e3c72;font-weight:800;font-size:22px;margin-bottom:18px;
  letter-spacing:0.5px;text-shadow:0 2px 4px rgba(0,0,0,0.1);
}
.instruction .intro {
  color:#2a5298;font-weight:700;font-size:16px;margin-bottom:20px;
  line-height:1.5;padding:0 15px;
}
.instruction .rules {
  background:rgba(30,60,114,0.05);border:2px solid rgba(30,60,114,0.2);
  border-radius:18px;padding:20px;margin:20px 0;font-size:15px;
  color:#1e3c72;line-height:1.6;
}
.instruction .rules ol {
  text-align:left;padding-left:25px;
}
.instruction .rules li {
  margin-bottom:8px;font-weight:500;
}
.instruction .lis {
  display:block;margin:25px 0 30px 0;font-size:17px;font-weight:800;
  color:#8b4513;background:rgba(255,248,225,0.8);
  padding:15px 20px;border:2px solid #daa520;border-radius:15px;
  box-shadow:0 8px 25px rgba(218,165,32,0.2);letter-spacing:0.2px;
}
.instruction .start-btn {
  display:inline-block;padding:14px 32px;background:linear-gradient(135deg,#1e3c72,#2a5298);
  color:#fff;font-size:16px;font-weight:700;border-radius:20px;
  box-shadow:0 8px 25px rgba(30,60,114,0.4);border:2px solid rgba(255,255,255,0.2);
  cursor:pointer;transition:all 0.3s ease;letter-spacing:0.5px;
  text-decoration:none;text-transform:uppercase;position:relative;overflow:hidden;
}
.instruction .start-btn:hover {
  transform:translateY(-2px);box-shadow:0 12px 35px rgba(30,60,114,0.6);
  background:linear-gradient(135deg,#2a5298,#1e3c72);
}
.instruction .start-btn:active {
  transform:translateY(0);box-shadow:0 5px 15px rgba(30,60,114,0.4);
}
@keyframes instructionSlide {
  0%{opacity:0;transform:translate(-50%,-50%) scale(0.7) translateY(30px)}
  100%{opacity:1;transform:translate(-50%,-50%) scale(1) translateY(0)}
}

.cats-container {
  position:absolute;top:0;left:0;width:100%;height:100vh;
  pointer-events:none;z-index:10;
}
.cat {
  position:absolute;width:55px;height:55px;border-radius:50%;
  display:flex;flex-direction:column;align-items:center;justify-content:center;
  font-size:19px;font-weight:900;color:#fff;
  cursor:pointer;box-shadow:0 8px 25px rgba(0,0,0,0.4);
  backdrop-filter:blur(10px);border:3px solid rgba(255,255,255,0.6);
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  pointer-events:auto;
  will-change: transform;
  transition: none;
}
.cat span{font-size:12px!important;line-height:1;font-weight:900!important;text-shadow:1px 1px 2px rgba(0,0,0,0.5)}

.cat:hover {
  transform:scale(1.25) !important;
  z-index:50;box-shadow:0 20px 40px rgba(0,0,0,0.8) !important;
}

.cat.collected {
  opacity:0.3;transform:scale(0.7);
  pointer-events:none;animation:collectedPulse 2s infinite;
  box-shadow:0 0 30px rgba(255,215,0,1);border-color:rgba(255,215,0,1);
  filter: drop-shadow(0 0 10px rgba(255,215,0,0.8));
}
@keyframes collectedPulse {
  0%,100%{opacity:0.3;transform:scale(0.7)}
  50%{opacity:0.5;transform:scale(0.85)}
}

.message {
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  background:rgba(255,255,255,0.95);backdrop-filter:blur(20px);
  padding:20px;border-radius:20px;box-shadow:0 15px 50px rgba(0,0,0,0.4);
  text-align:center;font-size:17px;max-width:380px;font-weight:500;
  border:2px solid rgba(255,255,255,0.8);z-index:200;
  animation:fadeInOut 3.5s forwards;
  pointer-events:none;
}
@keyframes fadeInOut {
  0%{opacity:0;transform:translate(-50%,-50%) scale(0.9)}
  20%{opacity:1;transform:translate(-50%,-50%) scale(1)}
  80%{opacity:1;transform:translate(-50%,-50%) scale(1)}
  100%{opacity:0;transform:translate(-50%,-30%) scale(1.05)}
}

.collected-count, .collected-list {
  pointer-events:none;z-index:100;
}

.collected-count {
  position:fixed;bottom:12px;right:12px;background:rgba(255,255,255,0.15);
  backdrop-filter:blur(15px);padding:10px 14px;border-radius:16px;
  font-size:14px;font-weight:600;color:#fff;box-shadow:0 6px 20px rgba(0,0,0,0.3);
  border:1px solid rgba(255,255,255,0.2);min-width:100px;
  text-align:center;
}
.collected-list {
  position:fixed;bottom:40px;left:12px;background:rgba(255,255,255,0.15);
  backdrop-filter:blur(15px);padding:10px 14px;border-radius:16px;
  font-size:13px;font-weight:600;color:#fff;box-shadow:0 6px 20px rgba(0,0,0,0.3);
  max-width:240px;max-height:95px;overflow-y:auto;
  border:1px solid rgba(255,255,255,0.2);
}
.collected-list .item {
  display:inline-block;margin:1px 2px;padding:3px 7px;background:rgba(255,255,255,0.3);
  border-radius:10px;border:1px solid rgba(255,255,255,0.5);color:#fff;
  font-size:12px;font-weight:700;margin-bottom:2px;
  box-shadow:0 1px 4px rgba(0,0,0,0.2);animation:popIn 0.3s ease-out
}
@keyframes popIn{0%{transform:scale(0)}100%{transform:scale(1)}}

.hearts{position:fixed;pointer-events:none;font-size:16px;z-index:150;animation:floatHearts 3s forwards}
@keyframes floatHearts{0%{opacity:1;transform:translateY(0)}100%{opacity:0;transform:translateY(-100px) scale(1.2)}}

.winmsg {
  position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);
  background:linear-gradient(135deg,rgba(255,255,255,0.98),rgba(248,250,252,0.95));
  backdrop-filter:blur(30px);padding:40px;border-radius:25px;
  box-shadow:0 35px 90px rgba(0,0,0,0.6);text-align:center;font-size:16px;
  max-width:480px;border:3px solid rgba(30,60,114,0.9);z-index:300;
  animation:victoryPulse 2.5s infinite;line-height:1.5;
  pointer-events:none;
}
.winmsg .final-phrase {
  display:block;margin:18px 0;padding:20px 25px;
  background:linear-gradient(135deg,rgba(30,60,114,0.08),rgba(42,82,152,0.1));
  border:2px solid rgba(30,60,114,0.4);border-radius:20px;
  box-shadow:0 10px 30px rgba(30,60,114,0.3);
  color:#1e3c72;font-weight:700;font-size:16px;letter-spacing:0.4px;
  position:relative;overflow:hidden;animation:phraseGlow 3s infinite;
}
.winmsg .final-phrase:nth-child(2){animation-delay:0.3s}
.winmsg .final-phrase:nth-child(3){animation-delay:0.6s}
@keyframes victoryPulse{0%,100%{transform:translate(-50%,-50%) scale(1)}50%{transform:translate(-50%,-50%) scale(1.02)}}
@keyframes phraseGlow{0%,100%{box-shadow:0 10px 30px rgba(30,60,114,0.3);border-color:rgba(30,60,114,0.4)}50%{box-shadow:0 15px 40px rgba(30,60,114,0.5);border-color:rgba(42,82,152,0.7)}}

@media(max-width:768px){
  .cat{width:48px;height:48px;font-size:17px}
  .cat span{font-size:11px!important}
  .header{font-size:14px;padding:8px 18px}
  .winmsg{padding:30px;font-size:15px;max-width:90vw}
  .collected-list{bottom:36px;left:8px;font-size:12px}
  .collected-count{bottom:8px;right:8px}
  .instruction{padding:30px;font-size:15px;max-width:90vw}
  .instruction .title{font-size:20px}
  .instruction .start-btn{padding:12px 28px;font-size:15px}
}
</style>

<script>
const elements=['H','He','Li','Be','B','C','N','O','F','Ne','Na','Mg','Al','Si','P'];
const colors=['#e91e63','#4db6ac','#2196f3','#ffeb3b','#ff9800','#f44336','#9c27b0','#cddc39','#e91e63','#ffeb3b','#f44336','#26a69a','#26c6da','#3f51b5','#9e9e9e'];

let collected = [];
let usedCompliments = [];
let gameStarted = false;
let catsContainer;
let cats = [];
let rafId;

const compliments = [
  '¬´–°–º–æ—Ç—Ä–∏, –∫–∞–∫–∞—è –¥–æ—Ä–æ–≥–∞ –∑–∞ –Ω–∞–º–∏‚Ä¶¬ª',
  '¬´–ù–∞—Å –Ω–µ —Ä–∞–∑–ª–µ–π –≤–æ–¥–æ–π, –∏ —ç—Ç–æ –ø—Ä–æ–≤–µ—Ä–µ–Ω–æ –≤—Ä–µ–º–µ–Ω–µ–º¬ª',
  '¬´–¢—ã ‚Äî –º–æ–π —Å–∞–º—ã–π –≥–ª–∞–≤–Ω—ã–π —á–µ–ª–æ–≤–µ–∫. –ë–µ–∑ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤¬ª',
  '¬´–ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –ø—Ä–æ—Å—Ç–æ –ø–µ—Ä–µ–∂–¥–∞—Ç—å –±—É—Ä—é, –¥–µ—Ä–∂–∞—Å—å –∑–∞ —Ä—É–∫–∏¬ª',
  '¬´–ú—ã –Ω–µ –∑—Ä—è –ø—Ä–æ—à–ª–∏ —á–µ—Ä–µ–∑ —Å—Ç–æ–ª—å–∫–æ–µ, —á—Ç–æ–±—ã —Å–¥–∞—Ç—å—Å—è —Å–µ–π—á–∞—Å¬ª',
  '¬´–¢–µ—Ä–ø–µ–Ω–∏–µ ‚Äî —ç—Ç–æ –Ω–µ —Å–ª–∞–±–æ—Å—Ç—å. –≠—Ç–æ –Ω–∞—à–∞ –æ–±—â–∞—è —Å–∏–ª–∞ —Å–µ–π—á–∞—Å¬ª',
  '¬´–Ø –ø–æ–º–Ω—é, –∫–∞–∫ –º—ã —Å–ø—Ä–∞–≤–ª—è–ª–∏—Å—å –∏ —Å —Ö—É–¥—à–∏–º. –°–ø—Ä–∞–≤–∏–º—Å—è –∏ —Å —ç—Ç–∏–º¬ª',
  '¬´–¢—ã –¥–ª—è –º–µ–Ω—è ‚Äî –Ω–µ –ø—Ä–æ—Å—Ç–æ –ª—é–±–∏–º–∞—è. –¢—ã ‚Äî –º–æ–π —Å–æ—é–∑–Ω–∏–∫¬ª',
  '¬´–°–∞–º—ã–µ –∫—Ä–∞—Å–∏–≤—ã–µ —Ä–∞—Å—Å–≤–µ—Ç—ã –±—ã–≤–∞—é—Ç –ø–æ—Å–ª–µ —Å–∞–º—ã—Ö —Ç—ë–º–Ω—ã—Ö –Ω–æ—á–µ–π¬ª',
  '¬´–ú—ã –º–æ–∂–µ–º –¥–∞—Ç—å –¥—Ä—É–≥ –¥—Ä—É–≥—É –≤—Ä–µ–º—è, –Ω–æ –Ω–µ –æ—Ç—Å—Ç—É–ø–∏–º¬ª',
  '¬´–ú–Ω–µ –Ω—É–∂–Ω–∞ —Ç—ã –≤ –º–æ—ë–º –±—É–¥—É—â–µ–º. –ü–æ—ç—Ç–æ–º—É –¥–∞–≤–∞–π –ø—Ä–æ–¥–µ—Ä–∂–∏–º—Å—è¬ª',
  '¬´–ù–∞—à –æ–±—â–∏–π ¬´—Ñ—É–Ω–¥–∞–º–µ–Ω—Ç¬ª —Å–ª–∏—à–∫–æ–º –∫—Ä–µ–ø–æ–∫, —á—Ç–æ–±—ã –µ–≥–æ –º–æ–≥–ª–æ –ø–æ–∫–æ–ª–µ–±–∞—Ç—å¬ª',
  '¬´–ò–Ω–æ–≥–¥–∞ –∂–∏–∑–Ω—å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞—Å –Ω–∞ –ø—Ä–æ—á–Ω–æ—Å—Ç—å. –î–∞–≤–∞–π –¥–æ–∫–∞–∂–µ–º, —á—Ç–æ –º—ã –µ—ë –≤—ã–¥–µ—Ä–∂–∏–º¬ª',
  '¬´–Ø –≤–µ—Ä—é –≤ –Ω–∞—Å. –î–∞–∂–µ –∫–æ–≥–¥–∞ —Ç—Ä—É–¥–Ω–æ. –û—Å–æ–±–µ–Ω–Ω–æ –∫–æ–≥–¥–∞ —Ç—Ä—É–¥–Ω–æ¬ª',
  '¬´–ú—ã —Å–æ–∑–¥–∞–Ω—ã –¥—Ä—É–≥ –¥–ª—è –¥—Ä—É–≥–∞, –ø—Ä–æ—Å—Ç–æ –Ω—É–∂–Ω–æ –≤ —ç—Ç–æ –ø–æ–≤–µ—Ä–∏—Ç—å¬ª'
];

function startGame() {
  document.getElementById('instruction').style.display = 'none';
  catsContainer = document.getElementById('catsContainer');
  catsContainer.style.display = 'block';
  gameStarted = true;
  initCats();
}

function shuffleArray(array) {
  const shuffled = [...array];
  for(let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

function getRandomCompliment() {
  const available = compliments.filter((_, i) => !usedCompliments.includes(i));
  if (available.length === 0) usedCompliments = [];
  const idx = Math.floor(Math.random() * available.length);
  const complimentIdx = compliments.indexOf(available[idx]);
  usedCompliments.push(complimentIdx);
  return available[idx];
}

function updateCollectedDisplay() {
  const itemsSpan = document.getElementById('collectedItems');
  const collectedSpan = document.getElementById('collected');
  itemsSpan.innerHTML = collected.map(el => `<span class="item">${el}</span>`).join('');
  collectedSpan.textContent = `${collected.length}/15`;
}

function createCat(el, index) {
  const cat = document.createElement('div');
  cat.className = 'cat';
  cat.dataset.element = el;
  
  const i = elements.indexOf(el);
  cat.style.background = `linear-gradient(135deg,${colors[i]},${colors[i]}88)`;
  cat.innerHTML = `üê±<br><span>${el}</span>`;
  
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–∏–∑–∏–∫–∏ —Å –ë–û–õ–¨–®–ò–ú–ò —Å–∫–æ—Ä–æ—Å—Ç—è–º–∏
  cat.radius = 27.5;
  cat.isCollected = false;
  cat.angle = Math.random() * Math.PI * 2;
  cat.speed = 1.5 + Math.random() * 2;
  cat.vx = Math.cos(cat.angle) * cat.speed;
  cat.vy = Math.sin(cat.angle) * cat.speed;
  cat.rotation = 0;
  cat.rotationSpeed = (Math.random() - 0.5) * 10;
  
  cat.addEventListener('click', function(e) {
    e.preventDefault();
    e.stopPropagation();
    
    if (!gameStarted || cat.isCollected) return;
    
    const next = collected.length;
    if (el === elements[next]) {
      collected.push(el);
      cat.isCollected = true;
      cat.vx = 0;
      cat.vy = 0;
      cat.classList.add('collected');
      updateCollectedDisplay();
      showCompliment(getRandomCompliment());
      createHearts();
      
      if (collected.length === 15) {
        setTimeout(() => document.getElementById('winmsg').style.display = 'block', 1200);
      }
    } else {
      showCompliment(elements[next]);
    }
  });
  
  return cat;
}

function initCats() {
  catsContainer.innerHTML = '';
  cats = [];
  const shuffledElements = shuffleArray([...elements]);
  
  shuffledElements.forEach((el, index) => {
    const cat = createCat(el, index);
    
    // –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —ç–∫—Ä–∞–Ω—É
    cat.x = 50 + (Math.random() - 0.5) * window.innerWidth * 0.6;
    cat.y = 50 + (Math.random() - 0.5) * window.innerHeight * 0.6;
    
    cat.style.left = `${cat.x}px`;
    cat.style.top = `${cat.y}px`;
    
    catsContainer.appendChild(cat);
    cats.push(cat);
  });
  
  animate();
}

function checkCollision(a, b) {
  const dx = b.x + b.radius - (a.x + a.radius);
  const dy = b.y + b.radius - (a.y + a.radius);
  return Math.sqrt(dx * dx + dy * dy) < a.radius + b.radius;
}

function resolveCollision(a, b) {
  // –†–∞—Å—á–µ—Ç –Ω–æ—Ä–º–∞–ª–∏ —Å—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è
  const dx = b.x - a.x;
  const dy = b.y - a.y;
  const distance = Math.sqrt(dx * dx + dy * dy);
  const nx = dx / distance;
  const ny = dy / distance;
  
  // –û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å
  const relativeVelocity = { x: b.vx - a.vx, y: b.vy - a.vy };
  
  // –ü—Ä–æ–µ–∫—Ü–∏—è —Å–∫–æ—Ä–æ—Å—Ç–∏ –Ω–∞ –Ω–æ—Ä–º–∞–ª—å
  const speed = relativeVelocity.x * nx + relativeVelocity.y * ny;
  
  if (speed > 0) return; // –†–∞–∑–ª–µ—Ç–∞—é—Ç—Å—è
  
  // –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —É–ø—Ä—É–≥–æ—Å—Ç–∏
  const impulse = 2 * speed / 2 * 1.1;
  
  // –ü—Ä–∏–º–µ–Ω—è–µ–º –∏–º–ø—É–ª—å—Å
  a.vx += impulse * nx;
  a.vy += impulse * ny;
  b.vx -= impulse * nx;
  b.vy -= impulse * ny;
  
  // –†–∞–∑–¥–µ–ª—è–µ–º –ø—Ä–∏–ª–∏–ø—à–∏–µ –æ–±—ä–µ–∫—Ç—ã
  const overlap = a.radius + b.radius - distance + 1;
  if (overlap > 0) {
    const separation = overlap / 2;
    a.x -= nx * separation;
    a.y -= ny * separation;
    b.x += nx * separation;
    b.y += ny * separation;
  }
}

function updateBounds() {
  const bounds = {
    left: 0,
    top: 0,
    right: window.innerWidth,
    bottom: window.innerHeight
  };
  return bounds;
}

let animationId;
function animate() {
  const bounds = updateBounds();
  
  cats.forEach(cat => {
    if (cat.isCollected) {
      cat.rotation += cat.rotationSpeed * 0.5;
      cat.style.transform = `rotate(${cat.rotation}deg)`;
      return;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é
    cat.x += cat.vx;
    cat.y += cat.vy;
    cat.rotation += cat.rotationSpeed;
    
    // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏–µ —Å–æ —Å—Ç–µ–Ω–∞–º–∏
    if (cat.x - cat.radius < bounds.left) {
      cat.x = bounds.left + cat.radius;
      cat.vx *= -1.05; // –ù–µ–º–Ω–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø—Ä–∏ –æ—Ç—Å–∫–æ–∫–µ
    }
    if (cat.x + cat.radius > bounds.right) {
      cat.x = bounds.right - cat.radius;
      cat.vx *= -1.05;
    }
    if (cat.y - cat.radius < bounds.top) {
      cat.y = bounds.top + cat.radius;
      cat.vy *= -1.05;
    }
    if (cat.y + cat.radius > bounds.bottom) {
      cat.y = bounds.bottom - cat.radius;
      cat.vy *= -1.05;
    }
    
    // –ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ —Ç—Ä–µ–Ω–∏–µ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ –¥–≤–∏–∂–µ–Ω–∏—è
    cat.vx *= 0.995;
    cat.vy *= 0.995;
    
    // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –≤–æ–∑–º—É—â–µ–Ω–∏–µ –¥–ª—è –∂–∏–≤–æ—Å—Ç–∏
    if (Math.random() < 0.02) {
      cat.vx += (Math.random() - 0.5) * 0.3;
      cat.vy += (Math.random() - 0.5) * 0.3;
    }
    
    // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å
    const speed = Math.sqrt(cat.vx * cat.vx + cat.vy * cat.vy);
    if (speed > 5) {
      cat.vx = (cat.vx / speed) * 5;
      cat.vy = (cat.vy / speed) * 5;
    }
    
    // –û–±–Ω–æ–≤–ª—è–µ–º DOM
    cat.style.left = `${cat.x}px`;
    cat.style.top = `${cat.y}px`;
    cat.style.transform = `rotate(${cat.rotation}deg)`;
  });
  
  // –°—Ç–æ–ª–∫–Ω–æ–≤–µ–Ω–∏—è –º–µ–∂–¥—É –∫–æ—Ç–∞–º–∏
  for (let i = 0; i < cats.length; i++) {
    for (let j = i + 1; j < cats.length; j++) {
      const cat1 = cats[i];
      const cat2 = cats[j];
      if (!cat1.isCollected && !cat2.isCollected && checkCollision(cat1, cat2)) {
        resolveCollision(cat1, cat2);
      }
    }
  }
  
  animationId = requestAnimationFrame(animate);
}

// Resize –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
window.addEventListener('resize', () => {
  if (cats.length > 0) {
    cats.forEach(cat => {
      if (!cat.isCollected) {
        cat.x = Math.max(30, Math.min(window.innerWidth - 30, cat.x));
        cat.y = Math.max(30, Math.min(window.innerHeight - 30, cat.y));
      }
    });
  }
});

function showCompliment(text) {
  const msgText = document.getElementById('msgText');
  const msg = document.getElementById('msg');
  msgText.textContent = text;
  msg.style.display = 'block';
  msg.style.animation = 'none';
  msg.offsetHeight;
  msg.style.animation = 'fadeInOut 3.5s forwards';
}

function createHearts() {
  for(let i = 0; i < 20; i++) {
    setTimeout(() => createHeart(), 30 * i);
  }
}

function createHeart() {
  const heart = document.createElement('div');
  heart.className = 'hearts';
  heart.innerHTML = 'üíñ';
  heart.style.left = Math.random() * 90 + 5 + 'vw';
  heart.style.top = '85vh';
  heart.style.color = '#ff69b4';
  heart.style.fontSize = (12 + Math.random() * 8) + 'px';
  document.body.appendChild(heart);
  setTimeout(() => heart.remove(), 3500);
}
</script>
</body>
</html>
